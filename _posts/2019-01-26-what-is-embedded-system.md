---
title: 01\. Embedded system 이란?
categories:
    - 임베디드 프로그래밍 C코드 최적화
tags:
    - Embedded system
    - Tool chain
    - Cross compile
    - Locate
toc: true
toc_label: "Contents"
toc_icon: "cog"
toc_sticky: true
---
## 임베디드 시스템이란?
PC는 범용목적의 컴퓨터이다. 소프트웨어 설치만하면 문서작업, 그래픽, 각종 멀티미디어 작업을 할 수 있다.  

하지만 임베디드 시스템은 특정한 목적을 가지고 설계된다.  
예를 들면 전자레인지가 있다. 전자레인지는 음식을 데우거나, 찜요리, 구이 등의 요리를 할 수 있도록 하는 시스템이다.  
전자레인지느 음식을 요리하는 열 시간도 다를 것이다. 이러한 기능적 요소들을 적절히 제공하려고 하드웨어를 제어하는 프로그램을 내장시켰고,  
사용자는 간편하게 버튼만 누르면 서비스를 받을 수 있다.  
또한, 현재 진행상태나 시간과 같은 정보들을 LCD와 LED 등을 통해 보여준다.  

이처럼 임베디드 시스템은 범용의 목적이 아닌 정해진 용도에 국한된 기능을 제공해 준다.  
범용의 목적이 아니므로 각 시스템은 특수 목적을 가지고 제작되기 때문에 시스템을 구성하는 장치나 소프트웨어가 제한적이다.

## 임베디드 시스템의 구현
임베디드 시스템이 구현은 회로를 이용해서 직접 하드웨어로만 구현할 수도 있고 하드웨어와 소프트웨어를 병행하여 구현할 수도 있다.  
하드웨어로만 사용해서 구현한다면 빠른 속도를 지원하지만, 기능을 수정하거나 확장하기가 어렵다.  
다시 추가 설계를 하여 하드웨어를 다시 생산해야하기 때문에 시간과 비용이 많이 소비된다.  
하지만, 소프트웨어와 병행한다면 비용을 많이 줄일 수 있고, 기능의 수정이나 확장이 쉬워진다.  

### 임베디드용 프로세서
PC에서는 주로 인텔 계열의 프로세서가 사용되지만 임베디드 시스템에 사용되는 프로세서는 아주 다양하다.  
대표적으로 ARM, MIPS, StrongARM SA1110, PPC, PXA255등이 있다.  

임베디드 프로세서는 다양하지만, 공통으로 고려해야 할 사항은 가격, 전력소모, 성능, 크기 등이다.  

## 임베디드 소프트웨어 개발방법
임베디드 시스템은 범용으로 만들어진 것이 아니라 특수 목적으로 만들어진다.  
특수 목적이라 함은 PC와 같이 모든 작업이 가능한 시스템이 아니라, 한두 종류의 기능에 특화되도록 시스템을 설계한다는 의미이다.  
따라서, 시스템을 구성하는 장치들이 PC와는 많이 다르다.  
예를 들어 입출력 장치는 키보드나 모니터가 아닌 LED나 LCD, 스위치 등으로 기능에 따라 다른 형태의 장치들이 쓰이고,  
메모리 역시 ROM/Flash, RAM으로 구성되어 있으며, HDD는 없다.  
따라서, PC처럼 시스템에서 직접 개발해야한다는 것은 불가능하며 이러한 문제를 해결해줄 수 있는 개발환경을 구축해야한다.  

PC용 소프트웨어를 개발할 때는 개발환경과 실행환경이 같다. 즉 개발하는 시스템의 프로세서와 프로그램이 실행될 시스템의 프로세서가 같다.  
이를 네이티브 개발환경이라고 한다.  

하지만, 임베디드 소프트웨어 개발환경을 개발하는 시스템의 프로세서와 실행될 시스템의 프로세서가 같지 않으며 이를 **크로스 개발환경**이라고 한다.  
개발환경의 프로세서를 위한 프로그램을 개발하는 것이 아니므로 생성되는 실행파일을 현 시스템에서 실행시키면 실행할 수 이없는 파일이라는 오류를 낸다.  
생성된 바이너리 코드를 현재 프로새서에서는 인식하지 못하기 때문이다.  
이 말은 일반 응용프로그램을 개발할 때 사용하는 컴파일러와는 다른 컴파일러를 사용해야 한다는 뜻이 된다.  
즉 임베디드 소프트웨어를 개발하려면 개발환경과 다른 프로세서용 기게코드를 생성해 주는 컴파일러가 필요하며 이를 **크로스 컴파일러**라고 한다.  
예를 들어 ARM용 크로스 컴파일러에는 arm-linux-gcc나 ADS등이 있다.

크로스 개발에서 소프트웨어를 개발하는 환경을 호스트 시스템, 소프트웨어가 실행되는 시스템을 타겟 시스템이라고 한다.  
쉽게 말해서 프로그램 개발작업을 하는 PC가 바로 호스트 시스템이 되고,  
임베디드 프로세서와 메모리 및 주변기기로 이루어진 임베디드 시스템이 바로 타겟 시스템이 되는 것이다.  

임베디드 소프트웨어 새발환경에는 호스트 시스템, 타겟 시스템 이외에도 소프트웨어 개발도구들이 필요하다.  
일반 소프트웨어을 개발할 때에도 컴파일러, 어셈블러, 링커 등이 필요하듯이, 임베디드 소프트웨어를 개발할 때에도 이러한 개발툴이 필요하다.  
하지만, 임베디드 시스템을 개발환경과 실행환경이 같지 않기 때문에 크로스 컴파일러나 크로스 어셈블러를 사용한다는 차이점이 있으며, 이를 **툴 체인(tool chain)**이라고 한다.  
툴체인은 크로스 컴파일러, 크로스 어셈블러, 링커/로케이터 등으로 수정된 소프트웨어 개발도구를 말한다.  
일반 PC용 컴파일러가 개발환경의 프로세서용 바이너리를 생성하는 반면, 크로스 컴파일러는 개발환경과 다른 타겟 시스템의 프로세서용 바이너리 코드를 생성한다.  

![크로스 컴파일 과정]({{ site.url }}{{ site.baseurl }}/assets/images/embedded-programming/what-is-embedded-system-01.jpeg){: .full}  

각 과정을 보면 PC와 큰 차이가 없지만 사용된 컴파일러나 어셈블러가 타겟 시스템을 위한 오브젝트 파일을 생성하는데 크로스 컴파일러와 크로스 어셈블러가 사용되었다.  
오브잭트 파일은 실행 가능한 바이너리 이미지로 변환되어야 하는데, 그 과정이 바로 **로케이트(locate)**이다.  
이때 타겟 보드의 메모리 정보를 로케이터에 알려주어야, 이 정보를 이용해서 실제 메모리 주소를 할당할 수 있다.  
로케이틑 프로그램 코드와 데이터 섹션들에 실제 메모리 주소를 할당하는 과정이다.  
타겟보드의 메모리 정보는 컴파일러의 옵션을 이용하여 설정할 수도 있고, 스크립트 파일을 사용할 수 있는데,  
주로 스크립트 파일이 사용된다.  
링커 스크립트에는 롬의 시작주소와 램의 시작주소, 각 섹션의 시작과 끝을 나타내는 심볼들로 구성되어 있다.  

## 프로그램을 타겟 시스템으로 옮기기
임베디드 시스템에서 직접 소프트웨어를 개발할 수 없으므로 PC에서 개발하고, 생성된 실행파일을 임베디드 시스템에 다운로드하여 작동시킨다.  
호스트에서 개발한 소프트웨어를 타겟 시스템에 전송하려면 시리얼, JTAG 또는 Ethernet/USB 케이블이 필요하다.  

시리얼 케이블은 UART 통신을 위한 케이블이다.  
UART란 범용 비동기화 송수신기(Universal Asyncronous Receive/Transmitter)로써 직렬 장치를 이용한 통신을 말한다.  
통신 내용은 시스템 콘솔을 사용해 확인 가능하다. 타겟 시스템의 프로그램이 제대로 작동되는지 모니터링 할 수 있고 디버깅도 가능하게 한다.  

JTAG 케이블은 타겟 시스템에 프로그램을 다운로드하거나 플래시 메모리에 프로그램을 탑재할 수있다.  
또 레지스터의 값을 읽어올 수 있거나 프로그램을 시스템으로 작동시키는 등 디버깅 기능도 가능하다.

이더넷/USB 케이블은 타겟 시스템에 개발한 소프트웨어를 탑재할 수 있다. 하지만 이들을 위한 추가 프로그램이 필요하다.  

<sub>
내용 참고: 임베디드 프로그래밍 C코드 최적화(Blog2Book)  
이미지 출처:  
    그림 1: 크로스 컴파일 과정 (https://shivan.tistory.com/23)
</sub>

<a href="#page-title" class="back-to-top">{{ site.data.ui-text[site.locale].back_to_top | default: 'Back to Top' }} &uarr;</a>
